# /claude-code-setup

Check status and manage your Claude Code Setup installation from within Claude.

## Usage

```
/claude-code-setup
```

## How It Works

The command runs in three phases, completing any scenario in just **2 permission prompts**.

### Phase 1: Discovery (1 Bash call)

Clones the repo and runs a discovery script that gathers all status info as JSON:

- Installed vs available version
- New modules (skills, MCP servers, plugins)
- Installed modules
- Custom repo status
- Agent Teams status

If the network is unavailable or the installation is missing, the command shows a message and stops gracefully.

### Phase 2: Present + Ask (0 Bash calls)

Shows your installation status and asks what you want to do. All options are generated from the discovery data — no additional shell commands needed.

### Phase 3: Execute (1 Bash call)

Chains all selected actions into a single command. Install, remove, and upgrade operations run in sequence, followed by cleanup.

## Example Output

### Status with upgrade available

```
claude-code-setup status:
- Base: v50 installed, v52 available
- Custom: v1 (up-to-date)
- Agent Teams: enabled

Modules available to install:
  Skills: standards-kotlin
  MCP Servers: brave-search
  External Plugins: document-skills

Changes in v51-v52:
- v52: Add /skill-creator command skill
- v51: Add standards-kotlin coding standards
```

### No upgrade available

```
claude-code-setup status:
- Base: v52 (up-to-date)
- Custom: (not configured)
- Agent Teams: enabled

Modules available to install:
  MCP Servers: brave-search

Tip: Use /add-custom <url> to add company modules.
```

## Available Actions

| Action | When shown |
|--------|-----------|
| Upgrade base | New version available |
| Upgrade custom | Custom repo has updates |
| Install new skills/MCP | Uninstalled modules exist |
| Install plugins | Uninstalled plugins exist |
| Remove modules | Installed modules exist |
| Enable Agent Teams | Not yet configured |

You can select multiple actions at once — they all execute in a single chained command.

## Modules Requiring API Keys

When installing MCP servers that require an API key (like `brave-search`), Claude inserts the config directly with a placeholder instead of using the interactive installer prompt.

```
MCP "brave-search" configured with placeholder.

Replace YOUR_API_KEY_HERE in ~/.claude.json with your actual key.

To get your API key:
1. Visit: https://brave.com/search/api/
2. Sign up for 'Data for AI' plan
3. Create an API key (free tier: 2000 queries/month)

Then restart Claude Code.
```

## External Plugins

External plugins (like `code-review-ai`) are installed via the Claude CLI:

1. Claude adds the marketplace if needed
2. Claude installs the plugin
3. You restart Claude Code to activate

## After Changes

After any install, upgrade, or removal:

```
Completed:
- Upgraded base: v50 -> v52
- Installed skill: standards-kotlin
- Enabled Agent Teams

IMPORTANT: Restart Claude Code now.
    After restart, run /catchup to reload context.
```

## Reducing Permission Prompts

By design, `/claude-code-setup` completes in 2 permission prompts (1 discovery + 1 execution). If you run it frequently and want to skip them, there are two approaches.

### Option 1: "Always allow" in the prompt

The easiest way. When Claude shows a permission prompt, select **"Always allow"** instead of "Allow". Claude Code automatically adds the correct pattern to `~/.claude/settings.json`. You only need to do this once per operation type.

### Option 2: Pre-configure in settings.json

Add patterns to `~/.claude/settings.json` before running the command:

```json
{
  "permissions": {
    "allow": [
      "Bash(*setup-status.sh*)",
      "Bash(*install.sh --update *)",
      "Bash(*install.sh --add-*)",
      "Bash(*install.sh --remove-*)",
      "Bash(rm -rf /tmp/claude-setup-*)"
    ]
  }
}
```

Each pattern matches a specific Bash call:

| Pattern | Which prompt |
|---------|-------------|
| `Bash(*setup-status.sh*)` | Phase 1 (discovery) |
| `Bash(*install.sh --update *)` | Phase 3 when upgrading |
| `Bash(*install.sh --add-*)` | Phase 3 when installing modules |
| `Bash(*install.sh --remove-*)` | Phase 3 when removing modules |
| `Bash(rm -rf /tmp/claude-setup-*)` | Phase 3 when nothing to do (cleanup only) |

The first pattern covers the discovery prompt. The remaining four cover Phase 3 — you only need the ones matching operations you use. In most cases, the first two patterns (discovery + upgrade) are enough.

If you already have a `permissions.allow` array in your settings, merge these entries into the existing array.

Patterns use glob syntax with `*` as wildcard. A space before `*` enforces a word boundary (`Bash(ls *)` matches `ls -la` but not `lsof`). See the [Claude Code permission docs](https://docs.anthropic.com/en/docs/claude-code/settings#permissions) for details.

## Related

- [Module Management](/features/module-management) - Terminal-based management with install.sh
- [/add-custom](/commands/add-custom) - Install custom modules
- [Installation](/getting-started/installation) - Initial setup
